// Prisma Scheme Atualizado por Nicolas
// Verificar se está tudo correto

//Tentei seguir a forma como está no pdf do esquema do banco de dados :)
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Event {
  id String @id @default(uuid())
  title String @db.VarChar(255)
  description String?
  creator_name String @db.VarChar(100)
  date_start DateTime
  date_end DateTime
  timezone String @db.VarChar(50)
  url_slug String @db.VarChar(20)
  created_at DateTime
  updated_at DateTime

  // Relacionamentos
  participants Participant[]
  time_slots TimeSlot[]
}

model Participant {
  id String @id @default(uuid())
  event_id String
  name String @db.VarChar(100)
  password_hash String @db.VarChar(255)
  created_at DateTime
  updated_at DateTime

  // Relacionamentos
  event Event @relation(fields: [event_id], references: [id])
  availabilities Availability[]
}

model TimeSlot {
  id String @id @default(uuid())
  event_id String
  start_time DateTime
  end_time DateTime
  created_at DateTime
  updated_at DateTime

  // Relacionamentos
  event Event @relation(fields: [event_id], references: [id])
  availabilities Availability[]
}

model Availability {
  participant_id String
  time_slot_id String
  status String @db.VarChar(20)
  created_at DateTime
  updated_at DateTime

  // Relacionamentos
  participant Participant @relation(fields: [participant_id], references: [id])
  time_slot TimeSlot @relation(fields: [time_slot_id], references: [id])

  @@id([participant_id, time_slot_id]) // Chave composta
}
